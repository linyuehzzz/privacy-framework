hist <- readr::read_csv("hist_new.csv", show_col_types = FALSE)
View(hist)
hist <- readr::read_csv("hist_new.csv", show_col_types = FALSE)
options(scipen=999)
hist <- readr::read_csv("data.csv", show_col_types = FALSE)
lm.fit1 = lm(diff ~ ., data=cancer)
lm.fit1 = lm(diff ~ ., data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
## Shapiro-Wilk test
shapiro.test(resid(lm.fit1))
## Kolmogorov-Smirnov test
ks.test(rstandard(lm.fit1), "pnorm")
qqPlot(rstandard(lm.fit1))
qqPlot(rstandard(lm.fit1))
library(car)
options(scipen=999)
hist <- readr::read_csv("data.csv", show_col_types = FALSE)
lm.fit1 = lm(diff ~ ., data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit1))
## Shapiro-Wilk test
shapiro.test(resid(lm.fit1))
## Kolmogorov-Smirnov test
ks.test(rstandard(lm.fit1), "pnorm")
boxcox(lm.fit1)
library(car)
library(MASS)
boxcox(lm.fit1)
lm.fit1 = lm(log(diff) ~ ., data=hist)
lm.fit1 = lm(sqrt(diff) ~ ., data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit1))
## Shapiro-Wilk test
shapiro.test(resid(lm.fit1))
## Kolmogorov-Smirnov test
ks.test(rstandard(lm.fit1), "pnorm")
summary(lm.fit1)
lm.fit1 = lm(diff ~ ., data=hist)
summary(lm.fit1)
lm.both.aic = step(lm.fit1, direction="both", k=2, trace=0)
summary(lm.both.aic)
par(mfrow=c(1, 2))
plot(fitted.values(lm.both.aic), residuals(lm.both.aic), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.both.aic))
plot(fitted.values(lm.both.aic), residuals(lm.both.aic), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
plot(fitted.values(lm.both.aic), residuals(lm.both.aic), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
lm.fit1 = lm(diff ~ black + aian, data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
hist <- readr::read_csv("data.csv", show_col_types = FALSE)
lm.fit1 = lm(diff ~ black, data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
options(scipen=999)
hist <- readr::read_csv("data.csv", show_col_types = FALSE)
lm.fit1 = lm(sqrt(diff) ~ black, data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit1))
lm.both.aic = step(lm.fit1, direction="both", k=2, trace=0)
summary(lm.both.aic)
lm.fit1 = lm(sqrt(diff) ~ ., data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit1))
lm.both.aic = step(lm.fit1, direction="both", k=2, trace=0)
summary(lm.both.aic)
lm.fit1 = lm(diff ~ ., data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit1))
lm.both.aic = step(lm.fit1, direction="both", k=2, trace=0)
summary(lm.both.aic)
boxcox(lm.fit1)
boxcox(diff ~ ., data=hist)
wt <- 1 / lm(abs(lm.fit1$residuals) ~ lm.fit1$fitted.values)$fitted.values^2
lm.fit2 = lm(diff ~ ., data=hist, weights=wt)
summary(lm.fit2)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit2), residuals(lm.fit2), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit2))
wt <- lm(abs(lm.fit1$residuals) ~ lm.fit1$fitted.values)$fitted.values^2
lm.fit2 = lm(diff ~ ., data=hist, weights=wt)
summary(lm.fit2)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit2), residuals(lm.fit2), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
wt <- fitted(lm(abs(residuals(lm.fit1)) ~ lm.fit1$fitted.values))^2
lm.fit2 = lm(diff ~ ., data=hist, weights=wt)
summary(lm.fit2)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit2), residuals(lm.fit2), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit2))
options(scipen=999)
hist <- readr::read_csv("data.csv", show_col_types = FALSE)
lm.fit1 = lm(diff**2 ~ ., data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit1))
lm.both.aic = step(lm.fit1, direction="both", k=2, trace=0)
summary(lm.both.aic)
lm.both.aic = step(lm.fit1, direction="both")
summary(lm.both.aic)
lm.both.aic = step(lm.fit1, direction="backward")
summary(lm.both.aic)
lm.both.aic = step(lm.fit1, direction="forward")
summary(lm.both.aic)
summary(lm.both.aic)
lm.both.aic = step(lm.fit1, direction="both")
summary(lm.both.aic)
library(car)
library(MASS)
library(glmnet)
library(dplyr)
y <- hist %>% select(diff) %>% scale(center = TRUE, scale = FALSE) %>% as.matrix()
X <- hist %>% select(-diff) %>% as.matrix()
lambdas_to_try <- 10^seq(-3, 5, length.out = 100)
ridge_cv <- cv.glmnet(X, y, alpha = 0, lambda = lambdas_to_try, standardize = TRUE, nfolds = 10)
plot(ridge_cv)
lambda_cv <- ridge_cv$lambda.min
model_cv <- glmnet(X, y, alpha = 0, lambda = lambda_cv, standardize = TRUE)
y_hat_cv <- predict(model_cv, X)
ssr_cv <- t(y - y_hat_cv) %*% (y - y_hat_cv)
rsq_ridge_cv <- cor(y, y_hat_cv)^2
lm.fit1 = lm(diff ~ ., data=hist)
summary(lm.fit1)
summary(model_cv)
lm.both.aic = step(lm.fit1, direction="both")
summary(lm.both.aic)
lm.both.aic = step(lm.fit1, direction="backward")
summary(lm.both.aic)
lambda_cv <- ridge_cv$lambda.min
model_cv <- glmnet(X, y, alpha = 0, lambda = lambda_cv, standardize = TRUE)
coef(model_cv, s = "lambda.min")
library(car)
library(MASS)
library(glmnet)
library(dplyr)
options(scipen=999)
hist <- readr::read_csv("data.csv", show_col_types = FALSE)
lm.fit1 = lm(diff ~ ., data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit1))
lm.both.aic = step(lm.fit1, direction="both")
summary(lm.both.aic)
y <- hist %>% select(diff) %>% scale(center = TRUE, scale = FALSE) %>% as.matrix()
X <- hist %>% select(-diff) %>% as.matrix()
lambdas_to_try <- 10^seq(-3, 5, length.out = 100)
ridge_cv <- cv.glmnet(X, y, alpha = 0, lambda = lambdas_to_try, standardize = TRUE, nfolds = 10)
plot(ridge_cv)
lambda_cv <- ridge_cv$lambda.min
model_cv <- glmnet(X, y, alpha = 0, lambda = lambda_cv, standardize = TRUE)
coef(model_cv, s = "lambda.min")
lm.fit1 = lm(diff ~ white*nh*nva, data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
lm.fit1 = lm(diff**2 ~ white*nh*nva, data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
lm.fit1 = lm(diff**2 ~ ., data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit1))
lm.both.aic = step(lm.fit1, direction="both")
summary(lm.both.aic)
y <- hist %>% select(diff) %>% scale(center = TRUE, scale = FALSE) %>% as.matrix()
X <- hist %>% select(-diff) %>% as.matrix()
lambdas_to_try <- 10^seq(-3, 5, length.out = 100)
ridge_cv <- cv.glmnet(X, y, alpha = 0, lambda = lambdas_to_try, standardize = TRUE, nfolds = 10)
plot(ridge_cv)
lambda_cv <- ridge_cv$lambda.min
model_cv <- glmnet(X, y, alpha = 0, lambda = lambda_cv, standardize = TRUE)
coef(model_cv, s = "lambda.min")
ridge_cv <- cv.glmnet(X, y**2, alpha = 0, lambda = lambdas_to_try, standardize = TRUE, nfolds = 10)
plot(ridge_cv)
lambda_cv <- ridge_cv$lambda.min
model_cv <- glmnet(X, y, alpha = 0, lambda = lambda_cv, standardize = TRUE)
coef(model_cv, s = "lambda.min")
ridge_cv <- cv.glmnet(X, y, alpha = 0, lambda = lambdas_to_try, standardize = TRUE, nfolds = 10)
plot(ridge_cv)
lambda_cv <- ridge_cv$lambda.min
model_cv <- glmnet(X, y, alpha = 0, lambda = lambda_cv, standardize = TRUE)
coef(model_cv, s = "lambda.min")
library(car)
library(MASS)
library(glmnet)
library(dplyr)
options(scipen=999)
hist <- readr::read_csv("data.csv", show_col_types = FALSE)
lm.fit1 = lm(diff**2 ~ ., data=hist)
lm.fit1 = lm(diff ~ ., data=hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit1))
lm.both.aic = step(lm.fit1, direction="both")
summary(lm.both.aic)
library(dplyr)
options(scipen=999)
hist <- readr::read_csv("data.csv", show_col_types = FALSE)
scaled.hist <- scale(hist)
lm.fit1 = lm(diff ~ ., data=scaled.hist)
scaled.hist <- (hist - mean(hist)) / sd(hist)
lm.fit1 = lm(diff ~ ., data=scaled.hist)
options(scipen=999)
hist <- readr::read_csv("data.csv", show_col_types = FALSE)
scaled.hist <- (hist - mean(hist)) / sd(hist)
hist <- readr::read_csv("data.csv", show_col_types = FALSE)
scaled.hist <- as.data.frame(scale(hist))
lm.fit1 = lm(diff ~ ., data=scaled.hist)
summary(lm.fit1)
par(mfrow=c(1, 2))
plot(fitted.values(lm.fit1), residuals(lm.fit1), pch=16,
xlab="Predicted Value", ylab="Residual", main="")
abline(h=0, lty=2)
qqPlot(rstandard(lm.fit1))
lm.both.aic = step(lm.fit1, direction="both")
summary(lm.both.aic)
